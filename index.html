<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Отправка данных в Telegram</title>
    <style>
        /* Стили из предыдущего примера остаются без изменений */
        body {
            font-family: Arial, sans-serif;
            max-width: 600px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background-color: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
        }
        /* ... остальные стили ... */
    </style>
</head>
<body>
    <div class="container">
        <h1>Оформление платежа</h1>
        
        <div class="instruction">
            <h3>Как получить QR-код из Т-банка:</h3>
            <ol>
                <li>Откройте Т-банк</li>
                <li>Перейдите в раздел "Счет"</li>
                <li>Прокрутите вниз до раздела "Пополнение"</li>
                <li>Найдите кнопку "QR-код для пополнения"</li>
                <li>Нажмите "Отправить QR-код"</li>
                <li>Сохраните изображение в файлы</li>
            </ol>
        </div>

        <form id="paymentForm">
            <div class="form-group">
                <label for="name">Ваше имя:</label>
                <input type="text" id="name" name="name" required>
            </div>
            
            <div class="form-group">
                <label for="phone">Номер телефона:</label>
                <input type="tel" id="phone" name="phone" required pattern="[0-9]{11}" placeholder="79123456789">
            </div>
            
            <div class="form-group">
                <label for="qrCode">QR-код из Т-банка:</label>
                <input type="file" id="qrCode" name="qrCode" accept="image/*" required>
            </div>
            
            <div class="preview">
                <img id="qrPreview" alt="Предпросмотр QR-кода">
            </div>
            
            <button type="submit">Отправить данные в Telegram</button>
        </form>

        <div id="statusMessage" style="margin-top: 20px; text-align: center; display: none;"></div>
    </div>

    <script>
        // Превью QR-кода
        document.getElementById('qrCode').addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(event) {
                    const img = document.getElementById('qrPreview');
                    img.src = event.target.result;
                    img.style.display = 'block';
                }
                reader.readAsDataURL(file);
            }
        });

        // Обработка формы
        document.getElementById('paymentForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const name = document.getElementById('name').value;
            const phone = document.getElementById('phone').value;
            const qrFile = document.getElementById('qrCode').files[0];
            const statusMessage = document.getElementById('statusMessage');
            
            // Показываем статус отправки
            statusMessage.style.display = 'block';
            statusMessage.textContent = "Отправка данных...";
            statusMessage.style.color = "#3498db";

            try {
                // 1. Создаем FormData для отправки
                const formData = new FormData();
                formData.append('chat_id', '283280949'); // Замените на ваш chat_id
                formData.append('caption', `Новый платеж!\nИмя: ${name}\nТелефон: ${phone}`);
                formData.append('photo', qrFile);

                // 2. Отправляем в Telegram
                const response = await fetch(`https://api.telegram.org/bot7871497047:AAE29U0GcJ9ENVAHalMjw6TEoLlXwLTn--g/sendPhoto`, {
                    method: 'POST',
                    body: formData
                });

                const result = await response.json();

                if (result.ok) {
                    statusMessage.textContent = "Данные успешно отправлены!";
                    statusMessage.style.color = "#2ecc71";
                    // Очищаем форму
                    this.reset();
                    document.getElementById('qrPreview').style.display = 'none';
                } else {
                    throw new Error(result.description || "Ошибка отправки");
                }
            } catch (error) {
                console.error("Ошибка:", error);
                statusMessage.textContent = `Ошибка: ${error.message}`;
                statusMessage.style.color = "#e74c3c";
            }
        });
    </script>
</body>
</html>
